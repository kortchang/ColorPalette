!function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=28)}({28:function(t,e,o){"use strict";o.r(e);function n(t,e,o,n,r,a){var l=0,i=.2126*t+.7156*e+.0722*o,c=.2126*n+.7156*r+.0722*a;return i>c?(c=c>.02?c:c+Math.pow(Math.abs(c-.02),1.75),(l=161.8*(Math.pow(i,.38)-Math.pow(c,.43)))<15?"0%":l.toPrecision(3)+"%"):(i=i>.02?i:i+Math.pow(Math.abs(i-.02),1.75),(l=161.8*(Math.pow(i,.5)-Math.pow(c,.43)))>-15?"0%":l.toPrecision(3)+"%")}figma.showUI(__html__,{height:500}),figma.on("selectionchange",()=>{l()}),figma.ui.onmessage=t=>{"update"===t.type&&(console.log("onUpdate"),"frame"==t.category&&l())};let r={type:"SOLID",color:{r:.2,g:.2,b:.2}},a={type:"SOLID",color:{r:1,g:1,b:1}};function l(){figma.loadFontAsync({family:"SF Pro Display",style:"Medium"}).then(()=>{figma.loadFontAsync({family:"SF Pro Display",style:"Semibold"}).then(()=>{figma.loadFontAsync({family:"PingFang TC",style:"Medium"}).then(()=>{const t=figma.currentPage.selection;console.log(`selection length ${t.length}, selection is ${t[0].type}`),1==t.length&&("FRAME"==t[0].type?function(t){console.log("update color palette");t.findChildren(t=>"INSTANCE"==t.type).map(t=>t).filter(t=>"ColorPalette/Color"==t.mainComponent.name).forEach(t=>{i(t)})}(t[0]):"INSTANCE"==t[0].type&&i(t[0]))})})})}function i(t){console.log("there are color single");const e=t.findChildren(t=>"INSTANCE"==t.type).map(t=>t).filter(t=>"ColorPalette/Children"==t.mainComponent.name);"ColorPalette/Children"==t.mainComponent.name&&c(t),e.forEach(t=>{c(t)})}function c(t){const e=t.children,o=e.find(t=>"RECTANGLE"==t.type);var l=e.filter(t=>"TEXT"==t.type).map(t=>t);e.filter(t=>"FRAME"==t.type).map(t=>t).forEach(t=>t.findChildren(t=>"TEXT"==t.type).forEach(t=>l.push(t)));const i=l.find(t=>t.name.startsWith("#")||"Color Hex"==t.name);console.log(`textNode: ${i}, shapeNode: ${o}`);const c=s(i),f=s(o),u=h(f),p=h(c);console.log(`hex: ${u}, textHex: ${p}`),i.deleteCharacters(0,i.characters.length),i.insertCharacters(0,u);const g=l.find(t=>"Contrast Ratio"==t.name),d=n(f.r,f.g,f.b,a.color.r,a.color.g,a.color.b),m=n(f.r,f.g,f.b,r.color.r,r.color.g,r.color.b);let y,b,M,C=parseFloat(d.substring(0,d.length-1)),S=parseFloat(m.substring(0,m.length-1));Math.abs(C)==Math.abs(S)||Math.abs(C)>=80&&Math.abs(S)>=80?(y=m,b=a,M=r):Math.abs(C)>Math.abs(S)?(y=d,b=a):(y=m,b=r),g.deleteCharacters(0,g.characters.length),g.insertCharacters(0,y),console.log("all text "+l),l.forEach(t=>{console.log(t.characters.length);try{t.setRangeFills(0,t.characters.length,[b]),M&&(t.strokes=[M])}catch(t){console.log(t)}}),console.log(`hex ${u}, ratio: ${y}, paint: ${1==b.color.r?"White":"Black"}`)}function s(t){return t.fills[0].color}function h(t){const e=Math.round(255*t.r),o=Math.round(255*t.g),n=Math.round(255*t.b);return"#"+e.toString(16).padStart(2,"0").padStart(2,"0")+o.toString(16).padStart(2,"0")+n.toString(16).padStart(2,"0")}}});